// ACCESSIBLE APP ACCORDION
// AUTHOR BRENTON KELLY - CREATIVE DEVELOPMENT MANAGER - BLACKBOARD INC.
// VERSION 04.17.19

!function(p){p.fn.csAppAccordion=function(e){var a={accordionBreakpoints:[960,768,640,480,320]};e&&p.extend(a,e);var i=document.createElement("style");if(i){i.setAttribute("type","text/css");var t=document.getElementsByTagName("head")[0];t&&t.insertBefore(i,t.childNodes[0]);var d='body:before {content: "desktop";display: none;}@media (max-width: 1023px) {body:before {content: "768";}}@media (max-width: 767px) {body:before {content: "640";}}@media (max-width: 639px) {body:before {content: "480";}}@media (max-width: 479px) {body:before {content: "320";}}';p.each(a.accordionBreakpoints,function(e,i){switch(i){case 960:d+='.tab-panel div.ui-widget.app div.ui-widget-detail.with-sideb[aria-hidden="false"],.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="false"] {width: auto !important;}.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="true"] {display: none !important;}.tab-panel div.ui-widget.app .ui-widget-detail.with-sidebar,.tab-panel div.ui-widget.app .ui-widget-sidebar {float: none;}';break;case 768:d+='@media (max-width: 1023px) {.tab-panel div.ui-widget.app div.ui-widget-detail.with-sidebar[aria-hidden="false"],.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="false"] {width: auto !important;}.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="true"] {display: none !important;}.tab-panel div.ui-widget.app .ui-widget-detail.with-sidebar,.tab-panel div.ui-widget.app .ui-widget-sidebar {float: none;}}';break;case 640:d+='@media (max-width: 767px) {.tab-panel div.ui-widget.app div.ui-widget-detail.with-sidebar[aria-hidden="false"],.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="false"] {width: auto !important;}.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="true"] {display: none !important;}.tab-panel div.ui-widget.app .ui-widget-detail.with-sidebar,.tab-panel div.ui-widget.app .ui-widget-sidebar {float: none;}}';break;case 480:d+='@media (max-width: 639px) {.tab-panel div.ui-widget.app div.ui-widget-detail.with-sidebar[aria-hidden="false"],.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="false"] {width: auto !important;}.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="true"] {display: none !important;}.tab-panel div.ui-widget.app .ui-widget-detail.with-sidebar,.tab-panel div.ui-widget.app .ui-widget-sidebar {float: none;}}';break;case 320:d+='@media (max-width: 479px) {.tab-panel div.ui-widget.app div.ui-widget-detail.with-sidebar[aria-hidden="false"],.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="false"] {width: auto !important;}.tab-panel div.ui-widget.app div.ui-widget-sidebar[aria-hidden="true"] {display: none !important;}.tab-panel div.ui-widget.app .ui-widget-detail.with-sidebar,.tab-panel div.ui-widget.app .ui-widget-sidebar {float: none;}}'}});var r=document.createTextNode(d);i.styleSheet?i.styleSheet.cssText=d:i.appendChild(r)}return this.each(function(){var i=this,t=!1,u={tab:9,enter:13,esc:27,space:32,end:35,home:36,left:37,up:38,right:39,down:40};function e(){var e=window.getComputedStyle(document.querySelector("body"),":before").getPropertyValue("content").replace(/"|'/g,"");"desktop"==e&&(e=960),e=parseInt(e),-1<a.accordionBreakpoints.indexOf(e)?function(){if(!t){p(".ui-widget.app",i).each(function(){p(".ui-widget-header",this).hasClass("ui-helper-hidden")||""==p.trim(p(".ui-widget-header",this).text())?p(this).addClass("no-header"):(p(".ui-widget-header",this).attr({role:"button",tabindex:"0","aria-expanded":"false"}),p(".ui-widget-detail, .ui-widget-sidebar, .ui-widget-footer",this).hide().attr("aria-hidden","true"))}),p(".ui-widget-header",i).not(p(".no-header .ui-widget-header")).click(function(){p(this).attr("aria-expanded","true"==p(this).attr("aria-expanded")?"false":"true").parent().toggleClass("open"),p("~ .ui-widget-detail",this).slideToggle("300","swing").attr("aria-hidden","true"==p("~ .ui-widget-detail",this).attr("aria-hidden")?"false":"true"),p("~ .ui-widget-sidebar",this).slideToggle("300","swing").attr("aria-hidden","true"==p("~ .ui-widget-sidebar",this).attr("aria-hidden")?"false":"true"),p("~ .ui-widget-footer",this).slideToggle("300","swing").attr("aria-hidden","true"==p("~ .ui-widget-footer",this).attr("aria-hidden")?"false":"true")}),p(".ui-widget-header",i).not(p(".no-header .ui-widget-header")).keydown(function(e){switch(e.keyCode){case u.space:case u.enter:e.preventDefault(),p(this).attr("aria-expanded","true"==p(this).attr("aria-expanded")?"false":"true").parent().toggleClass("open"),p("~ .ui-widget-detail",this).slideToggle("300","swing").attr("aria-hidden","true"==p("~ .ui-widget-detail",this).attr("aria-hidden")?"false":"true"),p("~ .ui-widget-sidebar",this).slideToggle("300","swing").attr("aria-hidden","true"==p("~ .ui-widget-sidebar",this).attr("aria-hidden")?"false":"true"),p("~ .ui-widget-footer",this).slideToggle("300","swing").attr("aria-hidden","true"==p("~ .ui-widget-footer",this).attr("aria-hidden")?"false":"true")}});var a=p(":not(.no-header) .ui-widget-header",i),d=p(a).index(p(a).first()),r=p(a).eq(p(a).index(p(a).first())),n=p(a).index(p(a).last()),s=p(a).eq(p(a).index(p(a).last()));p(a).keydown(function(e){var i=a.index(this),t=-1;switch(e.keyCode){case u.up:case u.left:e.preventDefault(),t=p(this).is(r)?n:i-1;break;case u.down:case u.right:e.preventDefault(),t=p(this).is(s)?d:i+1}-1!=t&&a.eq(t).focus()}),t=!0}}():t&&(p(".ui-widget.app",i).each(function(){p(this).removeClass("open"),p(".ui-widget-header",this).removeAttr("role tabindex aria-expanded"),p(".ui-widget-detail, .ui-widget-sidebar, .ui-widget-footer",this).removeAttr("style aria-hidden"),p(".ui-widget-sidebar",this).show()}),p(".ui-widget-header",i).unbind(),t=!1)}e(),p(window).resize(function(){e()})})}}(jQuery);